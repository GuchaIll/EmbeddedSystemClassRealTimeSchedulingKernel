<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.9.1"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>349 RTOS: kernel/src/servok.c File Reference</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen_style.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">349 RTOS </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part --><!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_3dd30a497388ee684638f120a124721c.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">servok.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements servo control system calls and a timer interrupt handler for PWM servo control <br  />
  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;syscall.h&gt;</code><br />
<code>#include &quot;gpio.h&quot;</code><br />
<code>#include &quot;timer.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:addf5ec070e9499d36b7f2009ce736076"><td class="memItemLeft" align="right" valign="top"><a id="addf5ec070e9499d36b7f2009ce736076"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a>&#160;&#160;&#160;__attribute__((unused))</td></tr>
<tr class="memdesc:addf5ec070e9499d36b7f2009ce736076"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attribute to mark unused function parameters. <br /></td></tr>
<tr class="separator:addf5ec070e9499d36b7f2009ce736076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadded3d85ac58720ef95b489d0c822bd"><td class="memItemLeft" align="right" valign="top"><a id="aadded3d85ac58720ef95b489d0c822bd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#aadded3d85ac58720ef95b489d0c822bd">PWM_PIN1</a>&#160;&#160;&#160;&quot;B3&quot;</td></tr>
<tr class="memdesc:aadded3d85ac58720ef95b489d0c822bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPIO pin for PWM signal to servo 1. <br /></td></tr>
<tr class="separator:aadded3d85ac58720ef95b489d0c822bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e6813f21869c3d2c242563f5163f48"><td class="memItemLeft" align="right" valign="top"><a id="a65e6813f21869c3d2c242563f5163f48"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#a65e6813f21869c3d2c242563f5163f48">PWM_PIN2</a>&#160;&#160;&#160;&quot;B10&quot;</td></tr>
<tr class="memdesc:a65e6813f21869c3d2c242563f5163f48"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPIO pin for PWM signal to servo 2. <br /></td></tr>
<tr class="separator:a65e6813f21869c3d2c242563f5163f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9d36b278ab88d4e5a32f7da0ac9d954d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#a9d36b278ab88d4e5a32f7da0ac9d954d">sys_servo_enable</a> (<a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t channel, <a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t enabled)</td></tr>
<tr class="memdesc:a9d36b278ab88d4e5a32f7da0ac9d954d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables or disables a servo.  <a href="servok_8c.html#a9d36b278ab88d4e5a32f7da0ac9d954d">More...</a><br /></td></tr>
<tr class="separator:a9d36b278ab88d4e5a32f7da0ac9d954d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab0a71094fd2dda9f507eaac8fd7c3af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#aab0a71094fd2dda9f507eaac8fd7c3af">sys_servo_set</a> (<a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t channel, <a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t angle)</td></tr>
<tr class="memdesc:aab0a71094fd2dda9f507eaac8fd7c3af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the servo pulse width based on the desired angle.  <a href="servok_8c.html#aab0a71094fd2dda9f507eaac8fd7c3af">More...</a><br /></td></tr>
<tr class="separator:aab0a71094fd2dda9f507eaac8fd7c3af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1a2c2e2c0978a49b3fbf9cd6254e0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#acf1a2c2e2c0978a49b3fbf9cd6254e0f">TIMER2_SERVO_IRQHandler</a> ()</td></tr>
<tr class="memdesc:acf1a2c2e2c0978a49b3fbf9cd6254e0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer interrupt handler for generating PWM signals to control servos.  <a href="servok_8c.html#acf1a2c2e2c0978a49b3fbf9cd6254e0f">More...</a><br /></td></tr>
<tr class="separator:acf1a2c2e2c0978a49b3fbf9cd6254e0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af7b0c189fcd2e8228dbd602d504260f2"><td class="memItemLeft" align="right" valign="top">volatile uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#af7b0c189fcd2e8228dbd602d504260f2">servo_enabled</a> [2] = {0, 0}</td></tr>
<tr class="memdesc:af7b0c189fcd2e8228dbd602d504260f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to track if the servos are enabled.  <a href="servok_8c.html#af7b0c189fcd2e8228dbd602d504260f2">More...</a><br /></td></tr>
<tr class="separator:af7b0c189fcd2e8228dbd602d504260f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fa083e1451b14d588a09dfde4b63510"><td class="memItemLeft" align="right" valign="top">volatile uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#a2fa083e1451b14d588a09dfde4b63510">servo_pulse_width</a> [2] = {0, 0}</td></tr>
<tr class="memdesc:a2fa083e1451b14d588a09dfde4b63510"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to store the pulse width for each servo.  <a href="servok_8c.html#a2fa083e1451b14d588a09dfde4b63510">More...</a><br /></td></tr>
<tr class="separator:a2fa083e1451b14d588a09dfde4b63510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1d60e47a550645dcf291034bb2fc99"><td class="memItemLeft" align="right" valign="top">volatile uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="servok_8c.html#acf1d60e47a550645dcf291034bb2fc99">timer_interval</a> = 0</td></tr>
<tr class="memdesc:acf1d60e47a550645dcf291034bb2fc99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timer interval counter for generating PWM signals.  <a href="servok_8c.html#acf1d60e47a550645dcf291034bb2fc99">More...</a><br /></td></tr>
<tr class="separator:acf1d60e47a550645dcf291034bb2fc99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements servo control system calls and a timer interrupt handler for PWM servo control <br  />
 </p>
<dl class="section date"><dt>Date</dt><dd>March 20 2025 <br  />
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Mario Cruz and Charlie Ai </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9d36b278ab88d4e5a32f7da0ac9d954d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d36b278ab88d4e5a32f7da0ac9d954d">&#9670;&nbsp;</a></span>sys_servo_enable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_servo_enable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t&#160;</td>
          <td class="paramname"><em>enabled</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables or disables a servo. </p>
<p>This function updates the enable status of the specified servo channel. If the servo is disabled, the corresponding GPIO pin is cleared.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>The servo channel (0 or 1). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">enabled</td><td>1 to enable the servo, 0 to disable it. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 if the channel is invalid. </dd></dl>

</div>
</div>
<a id="aab0a71094fd2dda9f507eaac8fd7c3af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab0a71094fd2dda9f507eaac8fd7c3af">&#9670;&nbsp;</a></span>sys_servo_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sys_servo_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="uart_8c.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a> uint8_t&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the servo pulse width based on the desired angle. </p>
<p>This function calculates the pulse width for the specified servo channel based on the desired angle (0 to 180 degrees). The pulse width is stored in the <code>servo_pulse_width</code> array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">channel</td><td>The servo channel (0 or 1). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>The desired angle (0 to 180 degrees). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 if the channel or angle is invalid. </dd></dl>

</div>
</div>
<a id="acf1a2c2e2c0978a49b3fbf9cd6254e0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf1a2c2e2c0978a49b3fbf9cd6254e0f">&#9670;&nbsp;</a></span>TIMER2_SERVO_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TIMER2_SERVO_IRQHandler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timer interrupt handler for generating PWM signals to control servos. </p>
<p>This function is called when the timer interrupt occurs. It generates PWM signals by setting and clearing the GPIO pins for the servos based on the current timer interval and the pulse width for each servo. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af7b0c189fcd2e8228dbd602d504260f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7b0c189fcd2e8228dbd602d504260f2">&#9670;&nbsp;</a></span>servo_enabled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint8_t servo_enabled[2] = {0, 0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array to track if the servos are enabled. </p>
<p>Each index corresponds to a servo channel (0 or 1). </p>

</div>
</div>
<a id="a2fa083e1451b14d588a09dfde4b63510"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fa083e1451b14d588a09dfde4b63510">&#9670;&nbsp;</a></span>servo_pulse_width</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint32_t servo_pulse_width[2] = {0, 0}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array to store the pulse width for each servo. </p>
<p>Each index corresponds to a servo channel (0 or 1). The pulse width is calculated based on the desired angle. </p>

</div>
</div>
<a id="acf1d60e47a550645dcf291034bb2fc99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf1d60e47a550645dcf291034bb2fc99">&#9670;&nbsp;</a></span>timer_interval</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile uint32_t timer_interval = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Timer interval counter for generating PWM signals. </p>
<p>This variable is incremented in the timer interrupt handler and is used to determine when to set or clear the GPIO pins for PWM generation. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
</body>
</html>
